{% for task_info in role.tasks %}
### File: `tasks/{{ task_info.file }}`
{% if task_info.tasks %}
| Task Name | Module | Description |
|-----------|--------|-------------|
{%- for task in task_info.tasks %}
| {{ task.name | escape_table_cell if task.name else '*unnamed*' }} | {{ task.module | escape_table_cell }} |
{%- if task_info.comments %}
{%- for comment in task_info.comments %}
{%- if comment.task_name == task.name %} {{ comment.task_comments | escape_table_cell }}{% endif %}
{%- endfor %}
{%- endif %} |
{%- endfor %}
{% endif %}

{# Mermaid diagram section with pagination support #}
{% if task_info.mermaid_diagram %}
{% if task_info.mermaid_diagram.paginated %}
{# Large diagram - show paginated version #}
**Task Flow Diagram** ({{ task_info.mermaid_diagram.pages | length }} pages - diagram is large)

{{ get_diagram_complexity_warning(task_info.mermaid_diagram.full_diagram) }}

<details>
<summary>ðŸ“Š View Full Diagram (may not render on all platforms)</summary>

```mermaid
{{ task_info.mermaid_diagram.full_diagram }}
```

</details>

{% for page in task_info.mermaid_diagram.pages %}
##### {{ page.title }}

```mermaid
{{ page.diagram }}
```

{% endfor %}
{% else %}
{# Normal single diagram #}
**Task Flow Diagram**

```mermaid
{{ task_info.mermaid_diagram.diagram }}
```

{% endif %}
{% endif %}

{% endfor %}
{% if not role.tasks %}*No tasks found in this role.*{% endif %}
